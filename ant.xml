
<project default="make" basedir=".">

  <property environment="env"/>

  <!--========== nuke ==========-->
  <target name="nuke">
    <delete dir="staging"/>
    <delete dir="dist"/>
  </target>

  <!--========== clean ==========-->
  <target name="clean">
    <delete dir="staging"/>
  </target>

  <!--========== compile ==========-->
  <target name="compile">

    <mkdir dir="staging"/>

    <javac
      srcdir="src"
      destdir="staging"
      source="1.4"
      target="1.4"
      debug="on"
      includeantruntime="false">
      <compilerarg value="-Xlint:deprecation"/>
      <classpath>
        <pathelement location="lib/servlet.jar" />
      </classpath>
    </javac>

  </target>

  <!--========== jar ==========-->
  <target name="jar">
    <mkdir dir="dist"/>
    <jar
      destfile="dist/haystack.jar"
      basedir="staging" />

  </target>

  <!--========== make ==========-->
  <target name="make" depends="clean,compile,jar"/>

  <!--========== test ==========-->
  <target name="test" depends="make">

    <java classname="org.projecthaystack.test.Test">
      <classpath>
        <pathelement location="dist/haystack.jar"/>
      </classpath>
    </java>

  </target> 

  <!--========== client ==========-->
  <target name="client" depends="make">

    <java classname="org.projecthaystack.client.HClient">
      <classpath>
        <pathelement location="dist/haystack.jar"/>
      </classpath>
      <arg value="${arg0}"/>
      <arg value="${arg1}"/>
      <arg value="${arg2}"/>
    </java>

  </target> 

</project>
